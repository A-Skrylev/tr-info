<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–µ–π—Ä–æ–∞—Ä—Ö–µ—Ç–∏–ø–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å–Ω–∏–∫ ¬∑ 12 —Å–∏—Å—Ç–µ–º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }

        body {
            background: linear-gradient(145deg, #0a0f1e 0%, #141b2b 100%);
            min-height: 100vh;
            color: #ecf0f5;
            padding: 1.5rem 1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(18, 26, 40, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(90, 120, 200, 0.15);
            border-radius: 2rem;
            padding: 2rem 2rem 2.5rem;
            box-shadow: 0 30px 45px -20px #000000cc;
        }

        h1 {
            font-size: 2.4rem;
            font-weight: 500;
            background: linear-gradient(135deg, #ffffff, #b0c8ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 0.4rem;
        }

        .subtitle {
            color: #95a9d9;
            font-size: 1rem;
            border-left: 3px solid #5272c4;
            padding-left: 1.2rem;
            margin: 0.8rem 0 1.8rem 0.2rem;
        }

        .progress {
            background: #1d263b;
            height: 10px;
            border-radius: 60px;
            margin: 25px 0 20px;
            border: 1px solid #33415e;
            overflow: hidden;
        }

        .progress-fill {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #5f7edb, #9f88e5);
            border-radius: 60px;
            transition: width 0.2s;
        }

        .question-container {
            background: #0e1629c9;
            border-radius: 2rem;
            padding: 2rem 2rem 1.8rem;
            border: 1px solid #32415f;
            margin: 1.8rem 0;
        }

        .scale-label {
            display: inline-block;
            background: #25324b;
            padding: 0.3rem 1.4rem;
            border-radius: 40px;
            font-size: 0.9rem;
            color: #bdd0ff;
            margin-bottom: 1rem;
            border: 1px solid #4b608b;
        }

        .question-text {
            font-size: 1.45rem;
            font-weight: 400;
            line-height: 1.4;
            margin-bottom: 2rem;
        }

        .likert {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 0.8rem;
            margin: 2rem 0 0.5rem;
        }

        .likert-option {
            flex: 1 0 70px;
            text-align: center;
        }

        .likert-option input[type="radio"] {
            display: none;
        }

        .likert-option label {
            display: block;
            background: #1b2440;
            border: 1px solid #3f4f74;
            border-radius: 40px;
            padding: 0.9rem 0.2rem;
            font-size: 0.95rem;
            color: #c4d0f0;
            cursor: pointer;
            transition: 0.1s;
            box-shadow: 0 4px 8px #00000050;
        }

        .likert-option input[type="radio"]:checked + label {
            background: #435e91;
            border-color: #9ab3ff;
            color: white;
            box-shadow: 0 0 15px #4a6bb0;
        }

        .likert-labels {
            display: flex;
            justify-content: space-between;
            color: #8295c0;
            font-size: 0.85rem;
            padding: 0 8px;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        button {
            background: #26334f;
            border: 1px solid #435983;
            color: white;
            font-size: 1.1rem;
            padding: 0.9rem 2.2rem;
            border-radius: 60px;
            cursor: pointer;
            transition: 0.1s;
            box-shadow: 0 6px 12px black;
        }

        button:hover:not(:disabled) {
            background: #33466b;
            border-color: #6a8bcf;
            transform: scale(1.02);
        }

        button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .counter {
            background: #1f2a40;
            padding: 0.5rem 1.8rem;
            border-radius: 60px;
            border: 1px solid #3b4d74;
            color: #b4c5fd;
        }

        .result-section {
            margin-top: 30px;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .result-title {
            font-size: 2rem;
            color: #f0f4ff;
            border-left: 6px solid #5f7edb;
            padding-left: 20px;
        }

        .score-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 25px 0;
            padding: 20px;
            background: #1b2540;
            border-radius: 24px;
        }

        .score-item {
            text-align: center;
        }

        .score-label {
            font-size: 0.85rem;
            color: #9aaeec;
            text-transform: uppercase;
        }

        .score-value {
            font-size: 1.8rem;
            font-weight: 600;
            margin-top: 5px;
        }

        .systems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .system-card {
            background: #1b253f;
            border-radius: 24px;
            padding: 20px;
            border: 1px solid #3d5182;
        }

        .system-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .system-name {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .system-category {
            font-size: 0.7rem;
            padding: 4px 12px;
            border-radius: 30px;
            background: #253458;
            border: 1px solid #6077bb;
        }

        .system-category.reptile { background: #2a3650; color: #b0c4ff; }
        .system-category.limbic { background: #2a3855; color: #b0c4ff; }
        .system-category.cortex { background: #332e55; color: #d4b0ff; }
        .system-category.meta { background: #4a3e2e; color: #ffd966; }

        .level-bar {
            height: 24px;
            background: #0b1324;
            border-radius: 40px;
            margin: 8px 0;
            overflow: hidden;
            display: flex;
        }

        .level-segment {
            height: 100%;
            transition: width 0.3s;
        }

        .level-1 { background: #3b4a6b; }
        .level-2 { background: #5f7edb; }
        .level-3 { background: #a886e5; }
        .level-4 { background: #d4af37; }

        .level-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #b0c4ff;
            margin: 5px 0;
        }

        .archetypes-section {
            background: #1b2946;
            border-radius: 32px;
            padding: 30px;
            margin: 40px 0;
            border: 2px solid #6b82c0;
        }

        .archetypes-title {
            font-size: 1.8rem;
            color: #e9c46a;
            margin-bottom: 25px;
        }

        .archetypes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .archetype-result-card {
            background: #253558;
            border-radius: 24px;
            padding: 20px;
            border-left: 6px solid;
        }

        .archetype-white { border-color: #4ade80; }
        .archetype-gray { border-color: #94a3b8; }
        .archetype-black { border-color: #f87171; }

        .archetype-result-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .archetype-match {
            font-size: 0.9rem;
            color: #b0c6ff;
            margin: 8px 0;
        }

        .confidence-bar {
            height: 8px;
            background: #1e2a45;
            border-radius: 10px;
            margin: 12px 0;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #5f7edb, #b07cf0);
            border-radius: 10px;
        }

        .systems-badge {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }

        .system-badge {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 12px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .correlation-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }

        .correlation-tag {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 12px;
            background: rgba(255,255,255,0.05);
        }

        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0 10px;
            font-size: 0.85rem;
            flex-wrap: wrap;
        }

        .legend span::before {
            content: "‚óè";
            margin-right: 6px;
            font-size: 1.2rem;
            vertical-align: middle;
        }
        .leg-reptile::before { color: #3b4a6b; }
        .leg-limbic::before { color: #5f7edb; }
        .leg-cortex::before { color: #a886e5; }
        .leg-meta::before { color: #d4af37; }
        .leg-white::before { color: #4ade80; }
        .leg-gray::before { color: #94a3b8; }
        .leg-black::before { color: #f87171; }

        .loading {
            text-align: center;
            padding: 60px;
            font-size: 1.2rem;
            color: #95a9d9;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-left: 10px;
            border: 2px solid #5f7edb;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            text-align: center;
            padding: 40px;
            background: #2a1f2f;
            border-radius: 24px;
            color: #fca5a5;
            margin: 30px 0;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            color: #5d71a0;
            font-size: 0.85rem;
        }

        .restart-btn {
            margin: 30px auto 0;
            display: block;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß¨ –ù–ï–ô–†–û–ê–†–•–ï–¢–ò–ü–ò–ß–ï–°–ö–ò–ô –û–ü–†–û–°–ù–ò–ö</h1>
        <div class="subtitle">12 —Å–∏—Å—Ç–µ–º ¬∑ 4 —É—Ä–æ–≤–Ω—è —Ä–∞–∑–≤–∏—Ç–∏—è ¬∑ 64 –∞—Ä—Ö–µ—Ç–∏–ø–∞</div>

        <!-- –ë–ª–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º, —Ç–æ–ª—å–∫–æ –ª–æ–∞–¥–µ—Ä –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ -->
        <div id="loadingIndicator" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –±–ª–æ–∫ (—Å–∫—Ä—ã—Ç –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏) -->
        <div id="mainContent" style="display: none;">
            <div class="progress"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
            
            <div id="quizBlock">
                <div class="question-container">
                    <span class="scale-label" id="currentScaleLabel">...</span>
                    <div class="question-text" id="currentQuestion">...</div>
                    <div class="likert" id="likertContainer"></div>
                    <div class="likert-labels">
                        <span>—Å–æ–≤—Å–µ–º –Ω–µ –ø—Ä–æ –º–µ–Ω—è</span>
                        <span>–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ</span>
                        <span>—Ç–æ—á–Ω–æ –ø—Ä–æ –º–µ–Ω—è</span>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button id="prevBtn" disabled>‚Üê –ù–∞–∑–∞–¥</button>
                    <span class="counter" id="questionCounter">1 / 60</span>
                    <button id="nextBtn">–î–∞–ª–µ–µ ‚Üí</button>
                </div>
            </div>

            <div id="resultBlock" style="display: none;"></div>
        </div>

        <div class="legend">
            <span class="leg-reptile"> —Ä–µ–ø—Ç–∏–ª—å–Ω—ã–µ</span>
            <span class="leg-limbic"> –ª–∏–º–±–∏—á–µ—Å–∫–∏–µ</span>
            <span class="leg-cortex"> –∫–æ—Ä–∫–æ–≤—ã–µ</span>
            <span class="leg-meta"> –º–µ—Ç–∞</span>
            <span class="leg-white"> –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫</span>
            <span class="leg-gray"> —Å–µ—Ä—ã–π —Å–ø–∏—Å–æ–∫</span>
            <span class="leg-black"> —á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫</span>
        </div>
        <footer>–æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ 12 –Ω–µ–π—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö ¬∑ –≤–µ—Ä—Å–∏—è 3.0</footer>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let archetypesDB = null;
        let questions = [];
        let answers = new Array(60).fill(3);
        let currentIndex = 0;

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const loadingIndicator = document.getElementById('loadingIndicator');
        const mainContent = document.getElementById('mainContent');
        const quizBlock = document.getElementById('quizBlock');
        const resultBlock = document.getElementById('resultBlock');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const counterSpan = document.getElementById('questionCounter');
        const questionDiv = document.getElementById('currentQuestion');
        const scaleSpan = document.getElementById('currentScaleLabel');
        const likertDiv = document.getElementById('likertContainer');
        const progressFill = document.getElementById('progressFill');

        // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        async function loadDatabase() {
            try {
                const response = await fetch('neyroarh64.json');
                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö');
                const data = await response.json();
                archetypesDB = data;
                
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤
                generateQuestions();
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                loadingIndicator.style.display = 'none';
                mainContent.style.display = 'block';
                
                // –ù–∞—á–∞—Ç—å –æ–ø—Ä–æ—Å
                renderQuestion();
            } catch (error) {
                loadingIndicator.innerHTML = `
                    <div class="error-message">
                        ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}<br>
                        –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª neyroarh64.json –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ
                    </div>
                `;
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è 12 —Å–∏—Å—Ç–µ–º
        function generateQuestions() {
            const systemQuestions = {
                '–¢–ï–†–†–ò–¢–û–†–ò–Ø': [
                    "–Ø –æ—Å—Ç—Ä–æ —á—É–≤—Å—Ç–≤—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –ª–∏—á–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ",
                    "–ú–µ–Ω—è —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç, –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ –≤—Ç–æ—Ä–≥–∞–µ—Ç—Å—è –Ω–∞ –º–æ—é —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é",
                    "–Ø —á—ë—Ç–∫–æ –º–∞—Ä–∫–∏—Ä—É—é —Å–≤–æ–∏ –≤–µ—â–∏ –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ",
                    "–ú–Ω–µ –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, –≥–¥–µ –º–æ–∏ –≥—Ä–∞–Ω–∏—Ü—ã",
                    "–Ø –∑–∞—â–∏—â–∞—é —Å–≤–æ—ë –º–µ—Å—Ç–æ –æ—Ç –ø–æ—Å—è–≥–∞—Ç–µ–ª—å—Å—Ç–≤"
                ],
                '–ò–ï–†–ê–†–•–ò–Ø': [
                    "–Ø –≤—Å–µ–≥–¥–∞ –∑–∞–º–µ—á–∞—é, –∫—Ç–æ –≤ –≥—Ä—É–ø–ø–µ –≥–ª–∞–≤–Ω—ã–π",
                    "–ú–Ω–µ –≤–∞–∂–Ω–æ –º–æ—ë –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –æ–±—â–µ—Å—Ç–≤–µ",
                    "–Ø —Å—Ç—Ä–µ–º–ª—é—Å—å –∫ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–º—É —Å—Ç–∞—Ç—É—Å—É",
                    "–Ø –ª–µ–≥–∫–æ –ø–æ–¥—á–∏–Ω—è—é—Å—å —Ç–µ–º, –∫—Ç–æ –≤—ã—à–µ, –∏ –∂–¥—É –ø–æ–¥—á–∏–Ω–µ–Ω–∏—è –æ—Ç —Ç–µ—Ö, –∫—Ç–æ –Ω–∏–∂–µ",
                    "–Ø —á—É–≤—Å—Ç–≤—É—é –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç, –µ—Å–ª–∏ –∏–µ—Ä–∞—Ä—Ö–∏—è –Ω–µ—è—Å–Ω–∞"
                ],
                '–†–ò–¢–£–ê–õ': [
                    "–Ø –ª—é–±–ª—é –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ä–∏—Ç—É–∞–ª—ã –∏ –ø—Ä–∏–≤—ã—á–∫–∏",
                    "–ú–Ω–µ –≤–∞–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π",
                    "–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –ø—Ä–∏–≤—ã—á–Ω–æ–≥–æ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞ –º–µ–Ω—è —Ç—Ä–µ–≤–æ–∂–∏—Ç",
                    "–£ –º–µ–Ω—è –µ—Å—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Ä–∏—Ç—É–∞–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —è —Å–æ–±–ª—é–¥–∞—é",
                    "–Ø —á—É–≤—Å—Ç–≤—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–∏ –∑–Ω–∞–∫–æ–º—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π"
                ],
                '–ü–û–ò–°–ö': [
                    "–ú–µ–Ω—è —Ç—è–Ω–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ",
                    "–Ø –ª–µ–≥–∫–æ –∑–∞–≥–æ—Ä–∞—é—Å—å –Ω–µ–∏–∑–≤–µ–¥–∞–Ω–Ω—ã–º",
                    "–°–∫—É–∫–∞ –¥–ª—è –º–µ–Ω—è –º—É—á–∏—Ç–µ–ª—å–Ω–∞",
                    "–Ø –≥–æ—Ç–æ–≤ —Ä–∏—Å–∫–æ–≤–∞—Ç—å —Ä–∞–¥–∏ –Ω–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞",
                    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –º–µ—Å—Ç–∞"
                ],
                '–°–¢–†–ê–•': [
                    "–Ø —á–∞—Å—Ç–æ —Ç—Ä–µ–≤–æ–∂—É—Å—å –æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ–ø–∞—Å–Ω–æ—Å—Ç—è—Ö",
                    "–ù–æ–≤—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –≤—ã–∑—ã–≤–∞—é—Ç —É –º–µ–Ω—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ",
                    "–Ø –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –∏–∑–±–µ–≥–∞—Ç—å —Ä–∏—Å–∫–∞",
                    "–ë—É–¥—É—â–µ–µ —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ",
                    "–Ø —Ç—â–∞—Ç–µ–ª—å–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞—é —É–≥—Ä–æ–∑—ã"
                ],
                '–ì–ù–ï–í': [
                    "–ú–µ–Ω—è –ª–µ–≥–∫–æ —Ä–∞–∑–æ–∑–ª–∏—Ç—å",
                    "–Ø –±—ã—Å—Ç—Ä–æ —Ä–µ–∞–≥–∏—Ä—É—é –Ω–∞ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å",
                    "–í –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ —è —Å–∫–æ—Ä–µ–µ –Ω–∞–ø–∞–¥–∞—é",
                    "–ú–Ω–µ —Ç—Ä—É–¥–Ω–æ —Å–¥–µ—Ä–∂–∞—Ç—å –≥–Ω–µ–≤, –∫–æ–≥–¥–∞ –º–µ–Ω—è –ø—Ä–æ–≤–æ—Ü–∏—Ä—É—é—Ç",
                    "–ö–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –º–µ—à–∞–µ—Ç, —è —Ä–∞–∑–¥—Ä–∞–∂–∞—é—Å—å"
                ],
                '–í–û–ñ–î–ï–õ–ï–ù–ò–ï': [
                    "–°–µ–∫—Å—É–∞–ª—å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–∞ –¥–ª—è –º–æ–µ–≥–æ —Å–∞–º–æ–æ—â—É—â–µ–Ω–∏—è",
                    "–Ø —á—É–≤—Å—Ç–≤—É—é —Å–∏–ª—å–Ω–æ–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –≤–ª–µ—á–µ–Ω–∏–µ",
                    "–ö—Ä–∞—Å–æ—Ç–∞ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ —Å–∏–ª—å–Ω–æ –Ω–∞ –º–µ–Ω—è –≤–ª–∏—è–µ—Ç",
                    "–Ø –∞–∫—Ç–∏–≤–Ω–æ –∏—â—É —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π",
                    "–î–ª—è –º–µ–Ω—è –≤–∞–∂–Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å"
                ],
                '–ü–†–ò–í–Ø–ó–ê–ù–ù–û–°–¢–¨': [
                    "–ú–Ω–µ –∂–∏–∑–Ω–µ–Ω–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–≤—è–∑—å —Å –±–ª–∏–∑–∫–∏–º–∏",
                    "–Ø —Ç—è–∂–µ–ª–æ –ø–µ—Ä–µ–∂–∏–≤–∞—é —Ä–∞–∑–ª—É–∫—É",
                    "–û–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ –¥–ª—è –º–µ–Ω—è –º—É—á–∏—Ç–µ–ª—å–Ω–æ",
                    "–Ø —Å–∏–ª—å–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Å—å –∫ –ª—é–¥—è–º",
                    "–ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –º–µ–Ω—è –ª—é–±—è—Ç"
                ],
                '–ó–ê–ë–û–¢–ê': [
                    "–Ø –ª—é–±–ª—é –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ –¥—Ä—É–≥–∏—Ö",
                    "–ú–Ω–µ –≤–∞–∂–Ω–æ –ø–æ–º–æ–≥–∞—Ç—å –±–ª–∏–∑–∫–∏–º",
                    "–Ø –≥–æ—Ç–æ–≤ –∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å —Å–≤–æ–∏–º –≤—Ä–µ–º–µ–Ω–µ–º —Ä–∞–¥–∏ –¥—Ä—É–≥–∏—Ö",
                    "–ú–µ–Ω—è —Ç—è–Ω–µ—Ç –æ–ø–µ–∫–∞—Ç—å –∏ –æ–±–µ—Ä–µ–≥–∞—Ç—å",
                    "–ó–∞–±–æ—Ç–∞ –ø—Ä–∏–Ω–æ—Å–∏—Ç –º–Ω–µ —Ä–∞–¥–æ—Å—Ç—å"
                ],
                '–ò–ì–†–ê': [
                    "–Ø –ª—é–±–ª—é –∏–≥—Ä–∞—Ç—å –∏ –¥—É—Ä–∞—á–∏—Ç—å—Å—è",
                    "–Æ–º–æ—Ä –ø–æ–º–æ–≥–∞–µ—Ç –º–Ω–µ —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏",
                    "–Ø –ª–µ–≥–∫–æ –æ—Ç–Ω–æ—à—É—Å—å –∫ –∂–∏–∑–Ω–∏",
                    "–ú–Ω–µ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –≤ –¥–µ–ª–µ –±—ã–ª —ç–ª–µ–º–µ–Ω—Ç –∏–≥—Ä—ã",
                    "–Ø –æ–±–æ–∂–∞—é –ø—Ä–∞–∑–¥–Ω–∏–∫–∏ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è"
                ],
                '–ö–û–ù–¢–†–û–õ–¨': [
                    "–Ø –≤—Å–µ–≥–¥–∞ –ø–ª–∞–Ω–∏—Ä—É—é —Å–≤–æ–∏ –¥–µ–ª–∞",
                    "–ú–Ω–µ –ª–µ–≥–∫–æ —Å–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è",
                    "–Ø –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –ø–æ—Ä—è–¥–æ–∫ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É",
                    "–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ –≤–∞–∂–Ω–µ–µ —Å–∏—é–º–∏–Ω—É—Ç–Ω—ã—Ö",
                    "–Ø –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫"
                ],
                '–°–û–¶–ò–ê–õ–¨–ù–û–°–¢–¨': [
                    "–Ø –ª–µ–≥–∫–æ –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ —á—É–≤—Å—Ç–≤—É—é—Ç –¥—Ä—É–≥–∏–µ",
                    "–ú–µ–Ω—è –≤–æ–ª–Ω—É–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å",
                    "–Ø —á–∞—Å—Ç–æ —Å—Ç–∞–≤–ª—é —Å–µ–±—è –Ω–∞ –º–µ—Å—Ç–æ –¥—Ä—É–≥–æ–≥–æ",
                    "–ú–Ω–µ –≤–∞–∂–Ω–æ, —á—Ç–æ –æ–±–æ –º–Ω–µ –¥—É–º–∞—é—Ç –æ–∫—Ä—É–∂–∞—é—â–∏–µ",
                    "–Ø —á—É–≤—Å—Ç–≤—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –æ–±—â–µ—Å—Ç–≤–æ–º"
                ],
                '–°–ú–´–°–õ': [
                    "–î–ª—è –º–µ–Ω—è –≤–∞–∂–Ω—ã –ø–æ–∏—Å–∫–∏ —Å–º—ã—Å–ª–∞ –∂–∏–∑–Ω–∏",
                    "–£ –º–µ–Ω—è –µ—Å—Ç—å —Å–∏—Å—Ç–µ–º–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä–æ–π —è —Å–ª–µ–¥—É—é",
                    "–ú–µ–Ω—è –≤–æ–ª–Ω—É—é—Ç –≤–æ–ø—Ä–æ—Å—ã –¥—É—Ö–æ–≤–Ω–æ—Å—Ç–∏",
                    "–Ø —Å—Ç—Ä–µ–º–ª—é—Å—å –∫ —á–µ–º—É-—Ç–æ –±–æ–ª—å—à–µ–º—É, —á–µ–º —è —Å–∞–º",
                    "–ú–æ–∏ —É–±–µ–∂–¥–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç –º–æ—é –∂–∏–∑–Ω—å"
                ]
            };

            // –°–æ–∑–¥–∞—ë–º –ø–ª–æ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
            const systemOrder = [
                '–¢–ï–†–†–ò–¢–û–†–ò–Ø', '–ò–ï–†–ê–†–•–ò–Ø', '–†–ò–¢–£–ê–õ',
                '–ü–û–ò–°–ö', '–°–¢–†–ê–•', '–ì–ù–ï–í', '–í–û–ñ–î–ï–õ–ï–ù–ò–ï', '–ü–†–ò–í–Ø–ó–ê–ù–ù–û–°–¢–¨', '–ó–ê–ë–û–¢–ê', '–ò–ì–†–ê',
                '–ö–û–ù–¢–†–û–õ–¨', '–°–û–¶–ò–ê–õ–¨–ù–û–°–¢–¨', '–°–ú–´–°–õ'
            ];

            questions = [];
            systemOrder.forEach(system => {
                if (systemQuestions[system]) {
                    questions.push(...systemQuestions[system]);
                }
            });
        }

        // –§—É–Ω–∫—Ü–∏–∏ –æ–ø—Ä–æ—Å–∞
        function renderQuestion() {
            const scaleIdx = Math.floor(currentIndex / 5);
            const systemName = Object.keys({
                '–¢–ï–†–†–ò–¢–û–†–ò–Ø':1,'–ò–ï–†–ê–†–•–ò–Ø':1,'–†–ò–¢–£–ê–õ':1,
                '–ü–û–ò–°–ö':1,'–°–¢–†–ê–•':1,'–ì–ù–ï–í':1,'–í–û–ñ–î–ï–õ–ï–ù–ò–ï':1,'–ü–†–ò–í–Ø–ó–ê–ù–ù–û–°–¢–¨':1,'–ó–ê–ë–û–¢–ê':1,'–ò–ì–†–ê':1,
                '–ö–û–ù–¢–†–û–õ–¨':1,'–°–û–¶–ò–ê–õ–¨–ù–û–°–¢–¨':1,'–°–ú–´–°–õ':1
            })[scaleIdx];
            
            scaleSpan.innerText = systemName;
            questionDiv.innerText = questions[currentIndex];

            let html = '';
            for (let i=1; i<=5; i++) {
                const checked = answers[currentIndex] === i ? 'checked' : '';
                html += `<div class="likert-option">
                    <input type="radio" name="likert" id="opt${i}" value="${i}" ${checked}>
                    <label for="opt${i}">${i}</label>
                </div>`;
            }
            likertDiv.innerHTML = html;

            document.querySelectorAll('input[name="likert"]').forEach(r => {
                r.addEventListener('change', (e) => {
                    answers[currentIndex] = parseInt(e.target.value);
                    updateNav();
                });
            });

            counterSpan.innerText = `${currentIndex+1} / 60`;
            progressFill.style.width = ((currentIndex+1)/60*100)+'%';
            updateNav();
        }

        function updateNav() {
            prevBtn.disabled = currentIndex === 0;
            nextBtn.innerText = currentIndex === 59 ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å' : '–î–∞–ª–µ–µ ‚Üí';
        }

        prevBtn.addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                renderQuestion();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentIndex < 59) {
                currentIndex++;
                renderQuestion();
            } else {
                calculateResults();
            }
        });

        // –†–∞—Å—á—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function calculateResults() {
            // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–∏–µ –ø–æ 12 —Å–∏—Å—Ç–µ–º–∞–º
            const systemScores = new Array(12).fill(0);
            for (let i=0; i<60; i++) {
                const systemIdx = Math.floor(i / 5);
                systemScores[systemIdx] += answers[i];
            }
            // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫ 0-1
            const normalizedScores = systemScores.map(s => (s - 5) / 20);

            // –ü–æ–∏—Å–∫ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∞—Ä—Ö–µ—Ç–∏–ø–æ–≤
            const matches = findMatchingArchetypes(normalizedScores);
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            showResults(normalizedScores, matches);
        }

        function findMatchingArchetypes(scores) {
            const matches = [];

            // –§—É–Ω–∫—Ü–∏—è —Å—Ö–æ–∂–µ—Å—Ç–∏ (—á–µ–º –º–µ–Ω—å—à–µ —Ä–∞–∑–Ω–∏—Ü–∞, —Ç–µ–º –ª—É—á—à–µ)
            function similarity(userScores, archetypeSystems) {
                // –°–æ–∑–¥–∞—ë–º –º–∞—Å—Å–∏–≤ –≤–µ—Å–æ–≤ –¥–ª—è —Å–∏—Å—Ç–µ–º –∞—Ä—Ö–µ—Ç–∏–ø–∞
                const systemWeights = new Array(12).fill(0);
                const systemNames = [
                    '–¢–ï–†–†–ò–¢–û–†–ò–Ø', '–ò–ï–†–ê–†–•–ò–Ø', '–†–ò–¢–£–ê–õ',
                    '–ü–û–ò–°–ö', '–°–¢–†–ê–•', '–ì–ù–ï–í', '–í–û–ñ–î–ï–õ–ï–ù–ò–ï', '–ü–†–ò–í–Ø–ó–ê–ù–ù–û–°–¢–¨', '–ó–ê–ë–û–¢–ê', '–ò–ì–†–ê',
                    '–ö–û–ù–¢–†–û–õ–¨', '–°–û–¶–ò–ê–õ–¨–ù–û–°–¢–¨', '–°–ú–´–°–õ'
                ];

                // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—Ä—Ö–µ—Ç–∏–ø–∞ —É –Ω–∞—Å –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∏—Å—Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ —É –Ω–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã
                // –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –∏–º –≤–µ—Å 1.0, –æ—Å—Ç–∞–ª—å–Ω—ã–º 0
                if (Array.isArray(archetypeSystems)) {
                    archetypeSystems.forEach(sys => {
                        // –£–±–∏—Ä–∞–µ–º —Å–∏–º–≤–æ–ª—ã ‚Üë‚Üì –¥–ª—è –ø–æ–∏—Å–∫–∞
                        const cleanSys = sys.replace('‚Üë', '').replace('‚Üì', '');
                        const idx = systemNames.indexOf(cleanSys);
                        if (idx !== -1) systemWeights[idx] = 1.0;
                    });
                }

                // –í—ã—á–∏—Å–ª—è–µ–º –≤–∑–≤–µ—à–µ–Ω–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É
                let diff = 0;
                let weightSum = 0;
                for (let i=0; i<12; i++) {
                    if (systemWeights[i] > 0) {
                        diff += Math.abs(userScores[i] - 0.7); // –û–∂–∏–¥–∞–µ–º –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
                        weightSum++;
                    }
                }
                const avgDiff = weightSum > 0 ? diff / weightSum : 1;
                return Math.max(0, 100 - avgDiff * 100);
            }

            // –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫
            if (archetypesDB?.archetypes?.white) {
                archetypesDB.archetypes.white.forEach(a => {
                    matches.push({
                        ...a,
                        confidence: similarity(scores, a.systems),
                        type: 'white'
                    });
                });
            }

            // –°–µ—Ä—ã–π —Å–ø–∏—Å–æ–∫
            if (archetypesDB?.archetypes?.gray) {
                archetypesDB.archetypes.gray.forEach(a => {
                    matches.push({
                        ...a,
                        confidence: similarity(scores, a.systems),
                        type: 'gray',
                        white_equivalent: a.white_equivalent,
                        broken: a.broken
                    });
                });
            }

            // –ß—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
            if (archetypesDB?.archetypes?.black) {
                archetypesDB.archetypes.black.forEach(a => {
                    matches.push({
                        ...a,
                        confidence: similarity(scores, a.systems),
                        type: 'black',
                        white_target: a.white_target,
                        transformation_path: a.transformation_path
                    });
                });
            }

            return matches.sort((a,b) => b.confidence - a.confidence).slice(0, 6);
        }

        function showResults(scores, matches) {
            quizBlock.style.display = 'none';
            resultBlock.style.display = 'block';

            const systemNames = [
                '–¢–ï–†–†–ò–¢–û–†–ò–Ø', '–ò–ï–†–ê–†–•–ò–Ø', '–†–ò–¢–£–ê–õ',
                '–ü–û–ò–°–ö', '–°–¢–†–ê–•', '–ì–ù–ï–í', '–í–û–ñ–î–ï–õ–ï–ù–ò–ï', '–ü–†–ò–í–Ø–ó–ê–ù–ù–û–°–¢–¨', '–ó–ê–ë–û–¢–ê', '–ò–ì–†–ê',
                '–ö–û–ù–¢–†–û–õ–¨', '–°–û–¶–ò–ê–õ–¨–ù–û–°–¢–¨', '–°–ú–´–°–õ'
            ];

            const avgReptile = (scores[0] + scores[1] + scores[2]) / 3 * 100;
            const avgLimbic = (scores[3] + scores[4] + scores[5] + scores[6] + scores[7] + scores[8]) / 6 * 100;
            const avgCortex = (scores[9] + scores[10]) / 2 * 100;
            const avgMeta = scores[11] * 100;

            let html = `
                <div class="result-header">
                    <div class="result-title">üìä –í–∞—à –ø—Ä–æ—Ñ–∏–ª—å —Ä–∞–∑–≤–∏—Ç–∏—è</div>
                </div>
                <div class="score-summary">
                    <div class="score-item">
                        <div class="score-label">—Ä–µ–ø—Ç–∏–ª—å–Ω—ã–π —Ç–æ–Ω—É—Å</div>
                        <div class="score-value">${avgReptile.toFixed(0)}%</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">–ª–∏–º–±–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
                        <div class="score-value">${avgLimbic.toFixed(0)}%</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">–∫–æ—Ä–∫–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å</div>
                        <div class="score-value">${avgCortex.toFixed(0)}%</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">–º–µ—Ç–∞-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</div>
                        <div class="score-value">${avgMeta.toFixed(0)}%</div>
                    </div>
                </div>
                <div class="systems-grid">
            `;

            // –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
            for (let i=0; i<12; i++) {
                let category = i<3 ? 'reptile' : (i<9 ? 'limbic' : (i<11 ? 'cortex' : 'meta'));
                let val = scores[i];
                html += `
                    <div class="system-card">
                        <div class="system-header">
                            <span class="system-name">${systemNames[i]}</span>
                            <span class="system-category ${category}">${category}</span>
                        </div>
                        <div class="level-bar">
                            <div class="level-segment level-2" style="width:${val*100}%;"></div>
                        </div>
                        <div class="level-stats">
                            <span>–∞–∫—Ç–∏–≤–∞—Ü–∏—è</span>
                            <span>${(val*100).toFixed(0)}%</span>
                        </div>
                    </div>
                `;
            }

            html += `</div>`;

            // –ü–æ–¥—Ö–æ–¥—è—â–∏–µ –∞—Ä—Ö–µ—Ç–∏–ø—ã
            html += `
                <div class="archetypes-section">
                    <div class="archetypes-title">üé≠ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∞—Ä—Ö–µ—Ç–∏–ø—ã</div>
                    <div class="archetypes-grid">
            `;

            matches.forEach(m => {
                let borderClass = m.type === 'white' ? 'archetype-white' : (m.type === 'gray' ? 'archetype-gray' : 'archetype-black');
                html += `
                    <div class="archetype-result-card ${borderClass}">
                        <div class="archetype-result-name">${m.name}</div>
                        <div class="archetype-match">—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ ${Math.round(m.confidence)}%</div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width:${m.confidence}%;"></div>
                        </div>
                        <div class="systems-badge">
                            ${Array.isArray(m.systems) ? m.systems.slice(0,3).map(s => 
                                `<span class="system-badge">${s}</span>`
                            ).join('') : ''}
                        </div>
                        ${m.cultural ? `<div style="font-size:0.9rem; margin:8px 0;">${Array.isArray(m.cultural) ? m.cultural.slice(0,2).join(', ') : m.cultural}</div>` : ''}
                        ${m.white_equivalent ? `<div style="font-size:0.85rem; color:#b0c4ff;">‚Üí –±–µ–ª—ã–π —ç—Ç–∞–ª–æ–Ω: ${m.white_equivalent}</div>` : ''}
                        ${m.broken ? `<div style="font-size:0.85rem; color:#b0c4ff;">‚ö†Ô∏è ${m.broken}</div>` : ''}
                        ${m.transformation_path ? `<div style="font-size:0.85rem; color:#b0c4ff;">üîÑ ${m.transformation_path}</div>` : ''}
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
                <button class="restart-btn" onclick="restartQuiz()">‚ü≤ –ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ</button>
            `;

            resultBlock.innerHTML = html;
        }

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
        window.restartQuiz = function() {
            answers.fill(3);
            currentIndex = 0;
            quizBlock.style.display = 'block';
            resultBlock.style.display = 'none';
            renderQuestion();
        };

        // –ó–∞–ø—É—Å–∫
        loadDatabase();
    </script>
</body>
</html>
